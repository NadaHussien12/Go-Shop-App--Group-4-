(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[90220],{704567:(e,t,i)=>{i.d(t,{t:()=>g,Z:()=>_});var n=i(27255),r=i(768559),s=i(124580),o=i(172071),a=i(402039),c=i(638525),l=i(12610),u=i(745760);const d=[9,3];function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const h=(0,u.ZP)();let m=null;class _{static getInstance(){return m||(m=new _),m}constructor(){p(this,"_logTimeoutLong",null),p(this,"_logTimeoutShort",null),p(this,"_clickthroughStartEvent",null),p(this,"_utcDate",new Date);const e=(e,t)=>{const{activeElement:i}=document;i&&i.id===n.Z.VIDEO_IFRAME_ID&&i?setTimeout((()=>i.blur()),0):(s.Z.pause(l.LU),this.flushEvents(e))},t=(e=>{let t=!1;return(...i)=>{t||(t=!0,e(...i))}})((t=>e(!0)));window.addEventListener("beforeunload",t),window.addEventListener("pagehide",t),window.addEventListener("focus",(()=>{s.Z.resume(l.LU)})),window.addEventListener("blur",(t=>e(!1)))}setTimeoutToFlushEvents(e){const t=e.event_type;if(d.includes(e.view_type)&&!this._logTimeoutShort&&13===t)this._logTimeoutShort=a.Z.setTimeout(this.flushEvents.bind(this,!1,!0),300);else if(!this._logTimeoutLong){const e=1e4;this._logTimeoutLong=a.Z.setTimeout(this.flushEvents.bind(this),e)}}addEvent(e,t){const i=e.event_type;if(null==i)return;if(!(0,u.cA)(e))return;this.setTimeoutToFlushEvents(e);const n=(0,u.li)(e,t),r=u.Ch[i];r?(0,u.nc)(n,r).forEach(h.logImpression):(o.Z.increment("webapp.contextLogger.impressionType",.01,{event_type:i}),h.logContextEvent(n),12===i&&(h.logContextEvent({...n,event_type:7946}),this._clickthroughStartEvent={...n,time:1e6*Date.now()},c.Z.storeClickthroughProperties({view_type:n.view_type,view_parameter:n.view_parameter,component:n.component,element:n.element,object_id_str:n.object_id_str,view_data:n.view_data,aux_data:n.aux_data,clientTrackingParams:n.clientTrackingParams})))}flushEvents(e){var t;const i=null===(t=h.getContextEvents)||void 0===t?void 0:t.call(h);i&&!i.length||(h.flushContextEvents(e),this._reset())}_reset(){this._resetShortTimerEvents(),this._resetLongTimerEvents()}_resetShortTimerEvents(){var e;null===(e=h.resetEventsBuffer)||void 0===e||e.call(h),clearTimeout(this._logTimeoutShort),this._logTimeoutShort=null}_resetLongTimerEvents(){var e;null===(e=h.resetEventsBuffer)||void 0===e||e.call(h),clearTimeout(this._logTimeoutLong),this._logTimeoutLong=null}logPlainObject(e){"event_type"in e&&this.addEvent({...e,..."aux_data"in e?{aux_data:{...e.aux_data}}:null})}}function g({location:e,reduxPins:t}){const i={flushContextEvents:e=>_.getInstance().flushEvents(e),logContextEvent:n=>{if(null===n.event_type||void 0===n.event_type)return;const s=n.clientTrackingParams||(i=>{try{const n=t&&i?t[i]:void 0;return n?(0,r.Z)(n,e)||`${n.tracking_params}~0`:void 0}catch(n){return}})(n.object_id_str);_.getInstance().addEvent({...n,clientTrackingParams:s},i.injectSetViewContextDataFromHook)},logImpression:({auxData:e,component:t,eventData:n,eventType:r,impressionType:s,objectIdStr:o,viewData:a,viewParameter:c,viewType:l})=>{null!=r&&_.getInstance().addEvent({event_type:r,event_data:{[s]:[n]},component:t,object_id_str:o,aux_data:e,view_type:l,view_parameter:c,view_data:a},i.injectSetViewContextDataFromHook)}};return i}window.addEventListener&&window.addEventListener("focus",(()=>{const e=_.getInstance();if(e._clickthroughStartEvent){const t=e._clickthroughStartEvent;e._clickthroughStartEvent=null;const i={...t,event_type:4100,duration_ns:(0,u.h1)()-t.time};e.addEvent(i)}}))},638525:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(704567),r=i(768559),s=i(704115),o=i(927955),a=i(433780);const c={},l=(0,s.Z)()&&(0,s.Z)().debug_timespent,u=(0,a.Z)({flushEvents:e=>{n.Z.getInstance().flushEvents(e)},shouldShowLogStatements:l,track:(e,t)=>{const i=n.Z.getInstance(),s=o.Z.instance.getState();let a;if(s.pins&&e){const{pair_id:i,event_type:n}=e;if(4703===n&&i&&c[i])e.clientTrackingParams=c[i];else{var l;const o=e.object_id_str,u=o?s.pins[o]:null,d=null==t||null===(l=t.current)||void 0===l?void 0:l.location,p=null==t?void 0:t.previous;u&&d&&(a=(0,r.Z)(u,d,p)||`${u.tracking_params||""}~0`,e.clientTrackingParams=a,4702===n&&i&&(c[i]=a))}}i.addEvent(e)}})},402039:(e,t,i)=>{let n;i.d(t,{Z:()=>s}),void 0===n&&(n=i.g);const r=function(e,t){const i=(r=t)===n.setTimeout?function(e,t){return n.setTimeout(e,t)}:r===n.setInterval?function(e,t){return n.setInterval(e,t)}:r===n.clearTimeout?function(e){return n.clearTimeout(e)}:r===n.clearInterval?function(e){return n.clearInterval(e)}:r;var r;return function(e,t,n,...r){return i(e,t,n,...r)}},s={setTimeout:r(0,n.setTimeout),setInterval:r(0,n.setInterval),clearTimeout:r(0,n.clearTimeout),clearInterval:r(0,n.clearInterval)}},927955:(e,t,i)=>{i.d(t,{Z:()=>n});const n=new class{get instance(){return this.__storeInstance__}set instance(e){return this.__storeInstance__=e,e}set(e){return this.instance=e,e}}},952712:(e,t,i)=>{i.d(t,{H:()=>c});var n=i(968630),r=i.n(n);var s=i(395164);const o=new class{constructor(e){this.table={},this.interval=e,this.lastCallTime=Date.now()}_garbageCollectEntries(){Date.now()-this.lastCallTime>this.interval&&(this.table={})}_generateHash(e){const t=Object.keys(e).sort(),i=[];return t.forEach((t=>{if(e[t]){let n=r()(e[t])?JSON.stringify(e[t]):e[t]+"";n=t+":"+n,i.push(n)}})),i.join("")}getTableKey(e){return e.auxData?this._generateHash(Object.assign({message:e.errorObj.message},e.auxData)):e.errorObj.message?e.errorObj.message:""}isWithinRateLimit(e){this._garbageCollectEntries();const t=Date.now();this.lastCallTime=t;const i=this.getTableKey(e);return this.table[i]&&t-this.table[i]<this.interval||(this.table[i]=t,!1)}}(5e3),a={};a._reportToConsole=(e,t={})=>{if(console&&console.error){const{name:i="",message:n="No message available",stack:r="No stack trace available"}=e,s=`Name: ${i}\nMessage: ${n}\n----------\nStack: \n${r}\n`;console.error(s,t)}},a._reportToServer=(e,t)=>{const i={errorObj:e};t&&(i.auxData=t),o.isWithinRateLimit(i)||(0,s.T)({...e,message_detail:t?JSON.stringify(t):""})};const c=(e,t)=>{const{columnNumber:i="",fileName:n="",lineNumber:r="",message:s="",original_message:o="",name:c="",stack:l="",stack_trace:u="",moduleName:d="",location:p=""}=e,h={columnNumber:i,fileName:n,lineNumber:r,message:o||s,name:c,stack:l||u,moduleName:d,location:p};a._reportToConsole(h,t),function(e){const t=e.http_status||e.httpStatus||e.status;if(404===t||500===t)return!1;const i=e.stack||e.stack_trace;return!(i&&-1!==i.indexOf("global code")||e.message&&("Connectivity error or cancelled by navigation"===e.message||e.message.includes("count mfss fcw")||e.message.includes("evaluating 'elem.classList'")))}(e)&&a._reportToServer(h,t)};a.report=c},433780:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(172071),r=i(245474);function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const o="ACTIVE",a="PAUSED",c=()=>window&&window.performance&&window.performance.now?`(Time: ${(window.performance.now()/1e3).toFixed(3)}s)`:"",l=({flushEvents:e,shouldShowLogStatements:t=!1,track:i})=>{const l=new Map,u=t?console:{error:(...e)=>{},log:(...e)=>{},group:(...e)=>{},groupEnd:(...e)=>{}};console.group||(u.group=(...e)=>console.log(...e),u.groupEnd=(...e)=>{});return new class{constructor(){s(this,"appTimedPair",null),s(this,"clickthroughProperties",null),s(this,"historyStackContext",null),s(this,"offsiteTimedPair",null),s(this,"offsiteTimedPairForegroundId",null),s(this,"addEventListeners",(()=>{let e,t;"undefined"!==document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange");const i=t=>{document[e]?this.unregisterApp(!1,void 0,t):document.hasFocus()&&this.registerApp()};t&&document.addEventListener(t,i,!1),window.addEventListener("focus",this.registerApp),window.addEventListener("blur",(e=>this.unregisterApp(!1,void 0,e)));const r=(e=>{let t=!1;return(...i)=>{t||(t=!0,e(...i))}})((e=>this.unregisterApp(!0,void 0,e)));window.addEventListener("beforeunload",r),window.addEventListener("pagehide",r);const s=navigator&&navigator.userAgent.toLowerCase();s&&s.includes("macintosh")&&s.includes("chrome")&&window.addEventListener("popstate",(t=>{document.hasFocus()||document[e]||n.Z.increment("chrome_mac_back_forward_button",1)}))})),s(this,"storeClickthroughProperties",(e=>{this.clickthroughProperties&&n.Z.increment("webapp.metrics.clickthroughs.overwritten",1,{previousView:this.clickthroughProperties.view_type,previousViewParameter:this.clickthroughProperties.view_parameter,nextView:e.view_type,nextViewParameter:e.view_parameter}),this.clickthroughProperties=e})),s(this,"clearClickthroughProperties",(()=>{this.clickthroughProperties=null,this.offsiteTimedPair=null,this.offsiteTimedPairForegroundId=null})),s(this,"registerApp",(()=>{u.group("App Foreground",c()),null==this.appTimedPair?(this.appTimedPair=new r.Z,this.appTimedPair.start(),this._unpauseAllComponents(),this._endOffsiteTimedPair(),null!==this.appTimedPair&&void 0!==this.appTimedPair&&i({event_type:4700,pair_id:this.appTimedPair.uuid},this.historyStackContext)):u.error("TimedPair already exists for app."),u.groupEnd()})),s(this,"unregisterApp",((t=!1,n=!1,r)=>{u.group("App Background",c());const s=this.appTimedPair;if(null!=s){this._pauseAllComponents();const e=s.end();this._startOffsiteTimedPair(),i({event_type:4701,duration_ns:e,pair_id:s.uuid},this.historyStackContext),this.appTimedPair=null}else u.error("No TimedPair found for app.");const o=["beforeunload","pagehide"],a=o.includes(null==r?void 0:r.type),l=o.includes(null==r?void 0:r.pauseReason);(a||l)&&this._endOffsiteTimedPair(),n||e(null!=t&&t),u.groupEnd()})),s(this,"_activateComponent",(e=>{u.group("Activating component",c()),t&&u.log(e.getContext());const n=e.getTimedPair();if(n){n.start();const{view:t,viewParameter:r,component:s,element:o,objectId:a,clientTrackingParams:c}=e.getLoggerContext();i({event_type:4702,view_type:t,view_parameter:r,component:s,element:o,object_id_str:a,view_data:e.props.viewData,pair_id:n.uuid,clientTrackingParams:c,aux_data:{time_spent_foreground_pairid:this.appTimedPair&&this.appTimedPair.uuid,time_spent_parent_pairid:e.getParentId(),...e.props.auxData}},this.historyStackContext)}u.groupEnd()})),s(this,"_deactivateComponent",(e=>{u.group("Deactivating component",c()),t&&u.log(e.getContext());const n=e.getTimedPair();if(n){const{view:t,viewParameter:r,component:s,element:o,objectId:a,clientTrackingParams:c}=n,l=n.end();i({event_type:4703,view_type:t,view_parameter:r,component:s,element:o,object_id_str:a,view_data:e.props.viewData,duration_ns:l,pair_id:n.uuid,clientTrackingParams:c,aux_data:{time_spent_foreground_pairid:this.appTimedPair&&this.appTimedPair.uuid,time_spent_parent_pairid:e.getParentId(),...e.props.auxData}},this.historyStackContext)}u.groupEnd()})),s(this,"_startOffsiteTimedPair",(()=>{const{clickthroughProperties:e}=this;e&&(this.offsiteTimedPair=new r.Z({...e,view:186,viewParameter:e.view_parameter,objectId:e.object_id_str}),this.offsiteTimedPair.start(),this.offsiteTimedPairForegroundId=this.appTimedPair?this.appTimedPair.uuid:null,i({...e,event_type:4702,view_type:186,pair_id:this.offsiteTimedPair?this.offsiteTimedPair.uuid:null,aux_data:{...e.aux_data,time_spent_foreground_pairid:this.offsiteTimedPairForegroundId}},this.historyStackContext))})),s(this,"_endOffsiteTimedPair",(()=>{const{offsiteTimedPair:e,clickthroughProperties:t}=this;if(e&&t){const n=e.end();i({...t,event_type:4703,view_type:186,pair_id:this.offsiteTimedPair?this.offsiteTimedPair.uuid:null,aux_data:{...t.aux_data,time_spent_foreground_pairid:this.offsiteTimedPairForegroundId},duration_ns:n},this.historyStackContext),this.clearClickthroughProperties()}})),s(this,"_pauseAllComponents",(()=>{u.group("Pause all components"),l.forEach(((e,t,i)=>{e===o&&this._deactivateComponent(t),i.set(t,a)})),u.groupEnd()})),s(this,"_unpauseAllComponents",(()=>{u.group("Unpause all components"),l.forEach(((e,t)=>{t.setTimedPair(new r.Z(t.getLoggerContext()))})),l.forEach(((e,t)=>{l.set(t,o),this._activateComponent(t)})),u.groupEnd()}))}setHistoryStackContext(e){this.historyStackContext=e}registerComponent(e){null===this.appTimedPair?l.set(e,a):(l.set(e,o),this._activateComponent(e))}unregisterComponent(e){l.get(e)===o&&(this._deactivateComponent(e),e.setTimedPair(new r.Z(e.getLoggerContext()))),l.delete(e)}size(){return l.size}}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/90220-236b763888ec8d8a.mjs.map